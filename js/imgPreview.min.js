"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(i,t,o){return t&&e(i.prototype,t),o&&e(i,o),i}}();!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(e,i){e.imgPreview=function(e){return new t(e)};var t=function(){function i(e){_classCallCheck(this,i),this.init(e)}return _createClass(i,[{key:"init",value:function(i){var t=this;this.config=e.extend(!0,{},{el:"[data-pic]",attr:"data-pic",attrTitle:"data-pic-title",attrDesc:"data-pic-desc",mode:"single",isMaskShow:!0,maskBgColor:"rgba(0,0,0,.5)"},i),this.allDom().each(function(i,o){var n=t;e(o).off("click").on("click",function(e){return n.preview(o)})})}},{key:"preview",value:function(i){var t=this,o=[e(window),e("body"),e(i)],n=o[0],r=o[1],a=o[2],c=[n.width(),n.height()],s=c[0],v=c[1],l=[a.attr(t.config.attr),a.attr(t.config.attrTitle),a.attr(t.config.attrDesc)],f=l[0],g=l[1],d=l[2],u=[event.clientX,event.clientY],p=u[0],w=u[1];if(t.imgPreviewMask=e('<div class="img-preview-mask" style="background-color: '+(t.config.maskBgColor||"rgba(0,0,0,.5)")+'"></div>'),t.imgPreviewPopover=e('<div class="img-preview-popover" style="top: '+w+"px;left: "+p+'px;"></div>'),t.imgPreviewBox=e('<div class="img-preview-box"></div>'),t.imgPreviewFoot=e('<div class="img-preview-foot"></div>'),"single"===t.config.mode){var m=new Image,P=function(i,o){o=t.isPc()?parseInt(s*o/i):o>=v?v:o,i=i>=s?s:i;var n={width:i,height:t.isPc()?"auto":o,top:parseInt((v-o)/2),left:parseInt((s-i)/2)};t.imgPreviewBox.append(e('<img style="cursor: zoom-out" src="'+f+'"/>')).click(function(){t.hide()}),t.config.isMaskShow&&(r.append(t.imgPreviewMask),t.imgPreviewMask.click(function(){t.hide()})),t.config.attrTitle&&t.imgPreviewFoot.append(e('<div class="img-foot-title">'+(g||"")+"</div>")),t.config.attrDesc&&t.imgPreviewFoot.append(e('<div class="img-foot-desc">'+(d||"")+"</div>")),t.imgPreviewPopover.append(t.imgPreviewBox),(g||d)&&t.imgPreviewPopover.append(t.imgPreviewFoot),r.append(t.imgPreviewPopover),e.fn&&e.fn.jquery?t.imgPreviewPopover.animate(n,300):t.imgPreviewPopover.css(n)};m.onload=function(){m.onload=null,P(m.width,m.height)},m.onerror=function(){alert("很抱歉，图片加载失败！")},m.src=f}}},{key:"isPc",value:function(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}},{key:"hide",value:function(){this.imgPreviewMask.remove(),this.imgPreviewPopover.remove()}},{key:"allDom",value:function(){return e(this.config.el)}}]),i}()});